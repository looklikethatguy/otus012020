Файл лога для анализа брал [здесь](http://greenolympiad.org/digishaala-access.log).

Примерный объём файла на момент анализа `access.log` - 106 Мб. Скорость анализа на не самом мощном компьютере составила около 10-15 сек. Второй запуск и анализ заняли 2-3 сек. Учитывая, что долгим по времени является только первый запуск скрипта, то нет, на мой взгляд, никакой нужды искуственно ограничивать количество обрабатываемых данных на входе.

В начале работы скрипта определяются переменные, затем создаётся локфайл, наличие которого предотвращает повторный запуск скрипта. Сигналом для удаления файла служит окончание работы скрипта.

После передачи данных в рабочий файл осуществляется проверка записей в файле лога работы скрипта - `scriptlog`. Это нужно для определения даты последней записи, на которой завершил работу скрипт в прошлый раз. Если нет файла или на входе пустая строка, то в файл записывается дата первой записи из логфайла, а скрипт начинает анализ с начала лога. В противном случае переменная получает значение последней даты и следующий анализ осуществляется от неё, убирая из рабочего файла все предущие строки.

Для правильной реализации удаления ненужных строк переменной `$LASTRUNTIME` передавалась дата после преобразования: `sed 's%/%\\\\/%g'`. Это сделано для экранирования "/" в записи времени и успешной передачи значения переменной на вход утилите `sed`.

Следующим этапом является формирование полезных данных и вывод хит-парада записей по каждой категории утилитой `head`, а утилита `mail` отправляет полученные данные на адрес root@localhost.

Результаты работы скрипта находятся в файлах `result1`, `result2` и `scriptlog`.
